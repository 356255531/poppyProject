As it is a pre-final result, the code environment
was not entirely clean. But as we wanted to ensure
the functionality, we did not change much afterwards.
- However, some functions are redundante and some variable
names may be misleading in this earlier version.